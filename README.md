# Qdrant HR ë°ì´í„°ë² ì´ìŠ¤ íŠœí† ë¦¬ì–¼

## ê°œìš”

ì´ íŠœí† ë¦¬ì–¼ì€ HR(ì¸ì‚¬) ë°ì´í„°ë² ì´ìŠ¤ì˜ Glossary(ìš©ì–´ì‚¬ì „), SQL History(ì¿¼ë¦¬ ê¸°ë¡), Data Catalog(ë©”íƒ€ë°ì´í„°)ë¥¼ Qdrant ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ê³  ê²€ìƒ‰í•˜ëŠ” ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤.

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
qdrant/
â”œâ”€â”€ start_qdrant.sh      # Qdrant ì„œë²„ ì‹œì‘ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ dummy_data_hr.py     # HR ìƒ˜í”Œ ë°ì´í„° ì •ì˜
â”œâ”€â”€ 01_qdrant_setup.py   # ë²¡í„° DB ì´ˆê¸° ì„¤ì • ë° ë°ì´í„° ì‚½ì…
â”œâ”€â”€ 02_read_demo.py      # ê²€ìƒ‰ ë° ì¡°íšŒ ì˜ˆì œ
â”œâ”€â”€ 03_update_demo.py    # ë°ì´í„° ì—…ë°ì´íŠ¸ ì˜ˆì œ
â”œâ”€â”€ 04_check_updates.py  # ë³€ê²½ ë‚´ì—­ ì¡°íšŒ ì˜ˆì œ
â”œâ”€â”€ pyproject.toml       # Python ì˜ì¡´ì„± ê´€ë¦¬
â””â”€â”€ README.md            # ì´ íŒŒì¼
```

## ì‚¬ì „ ì¤€ë¹„

### 1. Python í™˜ê²½ ì„¤ì •

Python 3.13 ì´ìƒì´ í•„ìš”í•©ë‹ˆë‹¤. ê°€ìƒí™˜ê²½ì„ ì„¤ì •í•˜ê³  ì˜ì¡´ì„±ì„ ì„¤ì¹˜í•˜ì„¸ìš”.

```bash
# uv ì‚¬ìš© ì‹œ (ê¶Œì¥)
uv sync

# ë˜ëŠ” pip ì‚¬ìš© ì‹œ
pip install -r pyproject.toml
```

### 2. Qdrant ì„œë²„ ì‹œì‘

Dockerë¥¼ ì‚¬ìš©í•˜ì—¬ Qdrant ì„œë²„ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.

```bash
chmod +x start_qdrant.sh
./start_qdrant.sh
```

ë˜ëŠ” ì§ì ‘ Docker ëª…ë ¹ì–´ ì‹¤í–‰:

```bash
docker run -d \
  -p 6333:6333 \
  -v $(pwd)/qdrant_storage:/qdrant/storage \
  --name qdrant \
  qdrant/qdrant
```

ì„œë²„ê°€ ì •ìƒì ìœ¼ë¡œ ì‹œì‘ë˜ì—ˆëŠ”ì§€ í™•ì¸:

```bash
curl http://localhost:6333/health
```

## ì‹¤í–‰ ìˆœì„œ

### Step 1: ë°ì´í„° ì´ˆê¸°í™” (01_qdrant_setup.py)

Qdrantì— ì»¬ë ‰ì…˜ì„ ìƒì„±í•˜ê³  HR ë°ì´í„°ë¥¼ ë²¡í„°ë¡œ ë³€í™˜í•˜ì—¬ ì‚½ì…í•©ë‹ˆë‹¤.

```bash
uv run 01_qdrant_setup.py
```

**ê¸°ëŒ€í•˜ëŠ” ë™ì‘:**

1. **hr_glossary ì»¬ë ‰ì…˜ ìƒì„±**
   - ìš©ì–´ì‚¬ì „ ë°ì´í„° (ì‚¬ë²ˆ, ë³¸ì‚¬, ì‹ ì… ë“±)
   - 1536ì°¨ì› ë²¡í„° (OpenAI text-embedding-3-small ëª¨ë¸ ì‚¬ìš©)
   - COSINE ê±°ë¦¬ ì¸¡ì •
   - `on_disk=True` ì„¤ì •ìœ¼ë¡œ ëŒ€ìš©ëŸ‰ ë°ì´í„° ì§€ì›

2. **hr_sql_history ì»¬ë ‰ì…˜ ìƒì„±**
   - SQL ì¿¼ë¦¬ ì´ë ¥ (ë¶€ì„œë³„ ì¸ì›, ê²°ê·¼ ì¡°íšŒ ë“±)
   - ê° ì¿¼ë¦¬ ì œëª©, ì„¤ëª…, SQL ë¬¸ì„ ë²¡í„°í™”

3. **hr_catalog ì»¬ë ‰ì…˜ ìƒì„±**
   - ë°ì´í„°ë² ì´ìŠ¤ ë©”íƒ€ë°ì´í„°
   - í…Œì´ë¸” ë‹¨ìœ„ë¡œ ì €ì¥: ê° í…Œì´ë¸”ì˜ ëª¨ë“  ì»¬ëŸ¼ ì •ë³´ë¥¼ í•˜ë‚˜ì˜ ë²¡í„°ë¡œ ì €ì¥
   - employees, departments, attendance, salary_history ë“±

**ì‹¤ì œ ì¶œë ¥:**

```
âœ… Upsert ì™„ë£Œ
```

**ì°¸ê³ :**
- OpenAI API í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤. `.env` íŒŒì¼ì— `OPENAI_API_KEY` í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ì„¸ìš”.
- ë²¡í„° ì°¨ì›ì€ 1536 (text-embedding-3-small ê¸°ë³¸ê°’)ì…ë‹ˆë‹¤.

### Step 2: ë°ì´í„° ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ (02_read_demo.py)

í•˜ë‚˜ì˜ ì§ˆë¬¸ìœ¼ë¡œ ëª¨ë“  ì»¬ë ‰ì…˜(Glossary, Catalog, SQL History)ì„ ë™ì‹œì— ê²€ìƒ‰í•˜ëŠ” í†µí•© ê²€ìƒ‰ ì˜ˆì œì…ë‹ˆë‹¤.

```bash
uv run 02_read_demo.py
```

**ê¸°ëŒ€í•˜ëŠ” ë™ì‘:**

1. **Glossary ê²€ìƒ‰** - ìš©ì–´ ë° ì •ì˜ ê²€ìƒ‰
   - ì¿¼ë¦¬: "ì§ê¸‰ë³„ í‰ê·  ì—°ë´‰ ì¡°íšŒ ë°©ë²•"
   - `type=glossary` í•„í„° ì ìš©
   - ìƒìœ„ 5ê°œ ê²°ê³¼ ë°˜í™˜ (ìœ ì‚¬ë„ ì ìˆ˜ í¬í•¨)

2. **Catalog ê²€ìƒ‰** - í…Œì´ë¸” ë° ì»¬ëŸ¼ ì •ë³´ ê²€ìƒ‰
   - ë™ì¼í•œ ì¿¼ë¦¬ë¡œ ê´€ë ¨ í…Œì´ë¸” ì „ì²´ ì •ë³´ ê²€ìƒ‰
   - ê²€ìƒ‰ëœ í…Œì´ë¸”ì˜ ëª¨ë“  ì»¬ëŸ¼ ì •ë³´ë¥¼ í•¨ê»˜ í‘œì‹œ
   - ìƒìœ„ 5ê°œ ê²°ê³¼ ë°˜í™˜

3. **SQL History ê²€ìƒ‰** - ê´€ë ¨ SQL ì¿¼ë¦¬ ì˜ˆì œ ê²€ìƒ‰
   - ë™ì¼í•œ ì¿¼ë¦¬ë¡œ ìœ ì‚¬í•œ SQL ì¿¼ë¦¬ ì´ë ¥ ê²€ìƒ‰
   - ìƒìœ„ 5ê°œ ê²°ê³¼ ë°˜í™˜

**ì‹¤ì œ ì¶œë ¥ ì˜ˆì‹œ:**

```
================================================================================
í†µí•© ê²€ìƒ‰ ì˜ˆì œ: í•˜ë‚˜ì˜ ì§ˆë¬¸ìœ¼ë¡œ ê´€ë ¨ ì •ë³´ ê²€ìƒ‰
================================================================================

ê²€ìƒ‰ ì§ˆë¬¸: 'ì§ê¸‰ë³„ í‰ê·  ì—°ë´‰ ì¡°íšŒ ë°©ë²•'

================================================================================
[1] Glossary ê²€ìƒ‰ (ìš©ì–´ ë° ì •ì˜)
================================================================================
ê²€ìƒ‰ ì‹œê°„: 2.73ms
ê²°ê³¼: 2ê±´

  [1] ì ìˆ˜: 0.4681 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
      ID: 8
      ì œëª©: ì—°ë´‰
      ì„¤ëª…: ì§ì›ì˜ ì—°ê°„ ê¸‰ì—¬ ê¸ˆì•¡

  [2] ì ìˆ˜: 0.3862 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
      ID: 6
      ì œëª©: ì§ê¸‰
      ì„¤ëª…: ì§ì›ì˜ ì§ìœ„ë‚˜ ê³„ê¸‰

================================================================================
[2] Catalog ê²€ìƒ‰ (í…Œì´ë¸” ë° ì»¬ëŸ¼ ì •ë³´)
================================================================================
ê²€ìƒ‰ ì‹œê°„: 1.19ms
ê²°ê³¼: 5ê±´

  [1] ì ìˆ˜: 0.2976 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
      ID: 1000
      í…Œì´ë¸”: employees
      ì„¤ëª…: ì§ì› ë§ˆìŠ¤í„°
      ì»¬ëŸ¼:
        - emp_id (UInt64): ì‚¬ë²ˆ
        - name (String): ì´ë¦„
        - title (String): ì§ê¸‰
        - dept_id (UInt32): ë¶€ì„œí‚¤
        - location (String): ê·¼ë¬´ì§€(Seoul-HQ ë“±)
        - hire_date (Date): ì…ì‚¬ì¼
        - employment_status (Enum('ACTIVE','LEFT')): ì¬ì§/í‡´ì‚¬
        - salary (UInt32): ì—°ë´‰(ë§Œì›)

  [2] ì ìˆ˜: 0.2767 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
      ID: 1005
      í…Œì´ë¸”: salary_history
      ì„¤ëª…: ê¸‰ì—¬ ì´ë ¥
      ì»¬ëŸ¼:
        - salary_id (UInt64): ê¸‰ì—¬ID
        - emp_id (UInt64): ì‚¬ë²ˆ
        - effective_date (Date): ì ìš©ì¼ì
        - salary (UInt32): ì—°ë´‰(ë§Œì›)
        - change_reason (String): ë³€ê²½ ì‚¬ìœ 

...

================================================================================
[3] SQL History ê²€ìƒ‰ (ê´€ë ¨ SQL ì¿¼ë¦¬ ì˜ˆì œ)
================================================================================
ê²€ìƒ‰ ì‹œê°„: 1.21ms
ê²°ê³¼: 5ê±´

  [1] ì ìˆ˜: 0.5350 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
      ID: 104
      ì œëª©: ì§ê¸‰ë³„ í‰ê·  ì—°ë´‰
      ì„¤ëª…: ì§ê¸‰ë³„ë¡œ ê·¸ë£¹í™”í•˜ì—¬ í‰ê·  ì—°ë´‰ ê³„ì‚°

...

================================================================================
ê²€ìƒ‰ ìš”ì•½
================================================================================
ì§ˆë¬¸: 'ì§ê¸‰ë³„ í‰ê·  ì—°ë´‰ ì¡°íšŒ ë°©ë²•'
ì´ ê²€ìƒ‰ ì‹œê°„: 5.03ms
  - Glossary: 2.56ms (2ê±´)
  - Catalog: 1.19ms (5ê±´)
  - SQL History: 1.21ms (5ê±´)
```

**ê²°ê³¼ í•´ì„:**
- í•˜ë‚˜ì˜ ì§ˆë¬¸ìœ¼ë¡œ Glossary(ìš©ì–´ ì •ì˜), Catalog(í…Œì´ë¸”/ì»¬ëŸ¼ ì •ë³´), SQL History(ì¿¼ë¦¬ ì˜ˆì œ)ë¥¼ ë™ì‹œì— ê²€ìƒ‰í•©ë‹ˆë‹¤.
- Catalog ê²€ìƒ‰ ì‹œ ê° í…Œì´ë¸”ì˜ ëª¨ë“  ì»¬ëŸ¼ ì •ë³´ë¥¼ í•œ ë²ˆì— í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê° ì»¬ë ‰ì…˜ë³„ ê²€ìƒ‰ ì‹œê°„ê³¼ ê²°ê³¼ ê°œìˆ˜ê°€ í‘œì‹œë©ë‹ˆë‹¤.
- ìœ ì‚¬ë„ ì ìˆ˜ëŠ” 0~1 ë²”ìœ„ì´ë©°, ì ìˆ˜ê°€ ë†’ì„ìˆ˜ë¡ ì˜ë¯¸ì ìœ¼ë¡œ ìœ ì‚¬í•©ë‹ˆë‹¤.

### Step 3: ë°ì´í„° ì—…ë°ì´íŠ¸ (03_update_demo.py)

ê¸°ì¡´ ë°ì´í„°ì˜ payload, ë²¡í„°ë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  ë³€ê²½ ì´ë ¥ì„ ì¶”ì í•©ë‹ˆë‹¤.

```bash
uv run 03_update_demo.py
```

**ê¸°ëŒ€í•˜ëŠ” ë™ì‘:**

1. **ë°°ì¹˜ ì—…ë°ì´íŠ¸**
   - ì—¬ëŸ¬ ìš©ì–´ì˜ ë™ì˜ì–´ë¥¼ í•œ ë²ˆì— ì—…ë°ì´íŠ¸
   - ë³€ê²½ ì´ë ¥ ìë™ ê¸°ë¡

2. **ì¡°ê±´ë¶€ ì—…ë°ì´íŠ¸**
   - íŠ¹ì • í…Œì´ë¸”ì˜ ì»¬ëŸ¼ ì„¤ëª…ì„ ì¡°ê±´ì— ë§ê²Œ ê°œì„ 
   - í•„í„°ë§ì„ í†µí•œ ì„ íƒì  ì—…ë°ì´íŠ¸

3. **ë²¡í„° ì¬ì„ë² ë”©**
   - ì„¤ëª…ì´ ë³€ê²½ëœ ê²½ìš° ìƒˆë¡œìš´ ë²¡í„° ìƒì„±
   - OpenAI APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì¬ì„ë² ë”©

4. **ë³€ê²½ ì´ë ¥ ì €ì¥**
   - ëª¨ë“  ë³€ê²½ì‚¬í•­ì„ payloadì— ê¸°ë¡
   - íƒ€ì„ìŠ¤íƒ¬í”„, ë³€ê²½ í•„ë“œ, ì‚¬ìœ  ë“± ì €ì¥

5. **ì¸ë±ìŠ¤ ìµœì í™”**
   - ì¡°íšŒ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•œ ì¸ë±ìŠ¤ ì¶”ê°€
   - TEXT, KEYWORD ì¸ë±ìŠ¤ ìƒì„±

**ì‹¤ì œ ì¶œë ¥ ì˜ˆì‹œ:**

```
================================================================================
ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸ ë°ëª¨
================================================================================

[1] ë°°ì¹˜ ì—…ë°ì´íŠ¸: ì—¬ëŸ¬ ìš©ì–´ì˜ ë™ì˜ì–´ ì¶”ê°€

  âœ“ ID 1: ìƒìƒë ¥ì´ í’ë¶€í•œ ë™ì˜ì–´ ì¶”ê°€ (ë°ëª¨ìš©)
    ì´ì „: 4ê°œ â†’ ì´í›„: 7ê°œ
  âœ“ ID 5: íŒíƒ€ì§€ ìš”ì†Œ ì¶”ê°€ (ë°ëª¨ìš©)
    ì´ì „: 4ê°œ â†’ ì´í›„: 6ê°œ
  âœ“ ID 6: ê²Œì„ ì„¸ê³„ê´€ ë°˜ì˜ (ë°ëª¨ìš©)
    ì´ì „: 5ê°œ â†’ ì´í›„: 6ê°œ

[2] ì¡°ê±´ë¶€ ì—…ë°ì´íŠ¸: íŠ¹ì • í…Œì´ë¸”ì˜ ì»¬ëŸ¼ ì„¤ëª… ê°œì„ 

  âœ“ ID 1008 (employees.salary): ì„¤ëª… ê°œì„ 
    ì´ì „: ì—°ë´‰(ë§Œì›)
    ì´í›„: ìš°ì£¼ ë³´ì„ì˜ ê°€ì¹˜ (ë³„ì˜ ê²°ì •ì²´ë¡œ ê³„ì‚°, 1ë§Œì› = í–‰ì„± 1ê°œ)

[3] ë²¡í„° ì¬ì„ë² ë”©: ê°œì„ ëœ ì„¤ëª…ìœ¼ë¡œ ë²¡í„° ì—…ë°ì´íŠ¸

  âœ“ ID 1 (ì‚¬ë²ˆ): ë²¡í„° ë° ì„¤ëª… ì¬ì„ë² ë”© ì™„ë£Œ

[4] ë³€ê²½ ì´ë ¥ì„ ë©”íƒ€ë°ì´í„°ë¡œ ì €ì¥

  âœ“ 5ê°œ í•­ëª©ì˜ ë³€ê²½ ì´ë ¥ ì €ì¥ ì™„ë£Œ

[5] ì¡°íšŒ ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•œ ì¸ë±ìŠ¤ ì¶”ê°€

  âœ“ hr_sql_history.title ì¸ë±ìŠ¤ ìƒì„± ì™„ë£Œ
  âœ“ hr_glossary.title ì¸ë±ìŠ¤ ìƒì„± ì™„ë£Œ

================================================================================
ì—…ë°ì´íŠ¸ ìš”ì•½
================================================================================
ì´ ì—…ë°ì´íŠ¸ í•­ëª© ìˆ˜: 5ê°œ

ë³€ê²½ ë‚´ì—­:
  [1] ID 1: synonyms
      ì‚¬ìœ : ìƒìƒë ¥ì´ í’ë¶€í•œ ë™ì˜ì–´ ì¶”ê°€ (ë°ëª¨ìš©)
      ì‹œê°: 2025-11-02T19:54:21.474159
  ...

âœ… ëª¨ë“  ì—…ë°ì´íŠ¸ ì‘ì—… ì™„ë£Œ
ğŸ’¡ ë³€ê²½ ë‚´ì—­ ì¡°íšŒëŠ” 'check_updates.py' íŒŒì¼ì„ ì‹¤í–‰í•˜ì„¸ìš”
```

**ê²°ê³¼ í•´ì„:**
- ë°°ì¹˜ ì—…ë°ì´íŠ¸ë¡œ ì—¬ëŸ¬ í•­ëª©ì„ í•œ ë²ˆì— ìˆ˜ì •í•©ë‹ˆë‹¤.
- ë³€ê²½ ì´ë ¥ì´ ìë™ìœ¼ë¡œ ê¸°ë¡ë˜ì–´ ì¶”ì  ê°€ëŠ¥í•©ë‹ˆë‹¤.
- ë²¡í„° ì¬ì„ë² ë”©ìœ¼ë¡œ ì˜ë¯¸ ë³€í™”ë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤.
- ì¸ë±ìŠ¤ ì¶”ê°€ë¡œ ê²€ìƒ‰ ì„±ëŠ¥ì´ í–¥ìƒë©ë‹ˆë‹¤.

### Step 4: ë³€ê²½ ë‚´ì—­ ì¡°íšŒ (04_check_updates.py)

ì—…ë°ì´íŠ¸ëœ ë°ì´í„°ì˜ ë³€ê²½ ì´ë ¥ì„ ì¡°íšŒí•˜ê³  í†µê³„ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.

```bash
uv run 04_check_updates.py
```

**ê¸°ëŒ€í•˜ëŠ” ë™ì‘:**

1. **íŠ¹ì • í¬ì¸íŠ¸ì˜ ë³€ê²½ ì´ë ¥ ì¡°íšŒ**
   - ID 1 (ì‚¬ë²ˆ)ì˜ ë³€ê²½ ì´ë ¥ ìƒì„¸ ì¡°íšŒ
   - í•„ë“œë³„ ë³€ê²½ ì „í›„ ë¹„êµ

2. **ìµœê·¼ ì—…ë°ì´íŠ¸ëœ í•­ëª© ì¡°íšŒ**
   - update_history í•„ë“œê°€ ìˆëŠ” ëª¨ë“  í•­ëª© ê²€ìƒ‰
   - ìµœê·¼ ì—…ë°ì´íŠ¸ ìˆœìœ¼ë¡œ ì •ë ¬

3. **íŠ¹ì • í•„ë“œ ì—…ë°ì´íŠ¸ ê²€ìƒ‰**
   - synonyms í•„ë“œê°€ ë³€ê²½ëœ í•­ëª©ë§Œ í•„í„°ë§
   - ë³€ê²½ëœ í•­ëª©ì˜ í˜„ì¬ ìƒíƒœ í™•ì¸

4. **ë³€ê²½ í†µê³„**
   - ì´ ë³€ê²½ ê±´ìˆ˜, ë³€ê²½ëœ í•­ëª© ìˆ˜
   - í•„ë“œë³„/ì‚¬ìœ ë³„ ë³€ê²½ í†µê³„

5. **ì—…ë°ì´íŠ¸ ì „í›„ ë¹„êµ**
   - íŠ¹ì • í•­ëª©ì˜ ìƒì„¸í•œ ë³€ê²½ ë‚´ì—­ í‘œì‹œ
   - ì¶”ê°€/ì œê±°ëœ í•­ëª© ê°•ì¡° í‘œì‹œ

**ì‹¤ì œ ì¶œë ¥ ì˜ˆì‹œ:**

```
================================================================================
ë³€ê²½ ë‚´ì—­ ì¡°íšŒ ë°ëª¨
================================================================================

[1] íŠ¹ì • í¬ì¸íŠ¸(ID: 1, ì‚¬ë²ˆ)ì˜ ë³€ê²½ ì´ë ¥

  ì œëª©: ì‚¬ë²ˆ
  ì„¤ëª…: ìš°ì£¼ë¥¼ ê´€ì¥í•˜ëŠ” ë§ˆë²•ì‚¬ì˜ ê³ ìœ  ë²ˆí˜¸ (ì‹œê°„ì˜ íë¦„ì„ ì œì–´í•˜ëŠ” í‚¤, ì°¨ì›ì„ ë„˜ë‚˜ë“œëŠ” ì‹ë³„ì)
  ë™ì˜ì–´: ì‚¬ë²ˆ, ì§ì›ID, ìš°ì£¼ì˜ ê³ ìœ ë²ˆí˜¸, ì™¸ê³„ì¸ ì‹ë³„ì, ë§ˆë²•ì˜ ìˆ«ì, ì‹œê°„ ì—¬í–‰ í‹°ì¼“, ì½”ìŠ¤ëª¨ìŠ¤ ID

  ë³€ê²½ ì´ë ¥ (2ê±´):
    [1] 2025-11-02 19:54:21
        í•„ë“œ: synonyms
        ì‚¬ìœ : ìƒìƒë ¥ì´ í’ë¶€í•œ ë™ì˜ì–´ ì¶”ê°€ (ë°ëª¨ìš©)
        ì´ì „ (4ê°œ): ì‚¬ë²ˆ, ì§ì›ID, employee id, uid
        ì´í›„ (7ê°œ): ì‚¬ë²ˆ, ì§ì›ID, ìš°ì£¼ì˜ ê³ ìœ ë²ˆí˜¸, ì™¸ê³„ì¸ ì‹ë³„ì, ë§ˆë²•ì˜ ìˆ«ì...
        âœ¨ ì¶”ê°€ë¨: ìš°ì£¼ì˜ ê³ ìœ ë²ˆí˜¸, ë§ˆë²•ì˜ ìˆ«ì, ì‹œê°„ ì—¬í–‰ í‹°ì¼“...
        ğŸ—‘ï¸  ì œê±°ë¨: uid, employee id

    [2] 2025-11-02 19:54:21
        í•„ë“œ: vector + description
        ì‚¬ìœ : íŒíƒ€ì§€ ì„¸ê³„ê´€ ì„¤ëª…ìœ¼ë¡œ ë²¡í„° ì¬ì„ë² ë”© ë° ì„¤ëª… ì™„ì „ ë³€ê²½ (ë°ëª¨ìš©)
        ğŸ”´ ì´ì „: ì‚¬ì› ê³ ìœ í‚¤
        ğŸŸ¢ ì´í›„: ìš°ì£¼ë¥¼ ê´€ì¥í•˜ëŠ” ë§ˆë²•ì‚¬ì˜ ê³ ìœ  ë²ˆí˜¸ (ì‹œê°„ì˜ íë¦„ì„ ì œì–´í•˜ëŠ” í‚¤, ì°¨ì›ì„ ë„˜ë‚˜ë“œëŠ” ì‹ë³„ì)
        âš ï¸  ì™„ì „íˆ ë‹¤ë¥¸ ë‚´ìš©ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!

[2] ìµœê·¼ ì—…ë°ì´íŠ¸ëœ ëª¨ë“  í•­ëª© ì¡°íšŒ

  ì´ 3ê°œ í•­ëª©ì´ ìµœê·¼ì— ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤:

  [1] ID 1: ì‚¬ë²ˆ
      ì—…ë°ì´íŠ¸ íšŸìˆ˜: 2íšŒ
      ìµœê·¼ ì—…ë°ì´íŠ¸: 2025-11-02 19:54:21

  [2] ID 6: ì§ê¸‰
      ì—…ë°ì´íŠ¸ íšŸìˆ˜: 1íšŒ
      ìµœê·¼ ì—…ë°ì´íŠ¸: 2025-11-02 19:54:21

  [3] ID 5: ë¶€ì„œ
      ì—…ë°ì´íŠ¸ íšŸìˆ˜: 1íšŒ
      ìµœê·¼ ì—…ë°ì´íŠ¸: 2025-11-02 19:54:21

[3] íŠ¹ì • í•„ë“œ(synonyms)ê°€ ì—…ë°ì´íŠ¸ëœ í•­ëª© ê²€ìƒ‰

  synonyms í•„ë“œê°€ ì—…ë°ì´íŠ¸ëœ í•­ëª©: 3ê°œ

  [1] ID 1: ì‚¬ë²ˆ
      í˜„ì¬ ë™ì˜ì–´ ìˆ˜: 7ê°œ
      ë™ì˜ì–´: ì‚¬ë²ˆ, ì§ì›ID, ìš°ì£¼ì˜ ê³ ìœ ë²ˆí˜¸, ì™¸ê³„ì¸ ì‹ë³„ì, ë§ˆë²•ì˜ ìˆ«ì...

[4] ë³€ê²½ í†µê³„

  ì´ ë³€ê²½ ê±´ìˆ˜: 4ê±´
  ë³€ê²½ëœ í•­ëª© ìˆ˜: 3ê°œ

  í•„ë“œë³„ ë³€ê²½ ê±´ìˆ˜:
    - synonyms: 3ê±´
    - vector + description: 1ê±´

  ë³€ê²½ ì‚¬ìœ ë³„ í†µê³„:
    - ìƒìƒë ¥ì´ í’ë¶€í•œ ë™ì˜ì–´ ì¶”ê°€ (ë°ëª¨ìš©): 1ê±´
    - íŒíƒ€ì§€ ì„¸ê³„ê´€ ì„¤ëª…ìœ¼ë¡œ ë²¡í„° ì¬ì„ë² ë”© ë° ì„¤ëª… ì™„ì „ ë³€ê²½ (ë°ëª¨ìš©): 1ê±´
    ...

[5] ì—…ë°ì´íŠ¸ ì „í›„ ë¹„êµ (ID: 1)

  synonyms í•„ë“œ ë³€ê²½ ë‚´ì—­:

    ğŸ”´ ì´ì „ ë™ì˜ì–´ (4ê°œ):
      [1] ì‚¬ë²ˆ
      [2] ì§ì›ID
      [3] employee id
      [4] uid

    ğŸŸ¢ ì´í›„ ë™ì˜ì–´ (7ê°œ):
      [1] ì‚¬ë²ˆ
      [2] ì§ì›ID
      [3] ìš°ì£¼ì˜ ê³ ìœ ë²ˆí˜¸
      [4] ì™¸ê³„ì¸ ì‹ë³„ì
      [5] ë§ˆë²•ì˜ ìˆ«ì
      [6] ì‹œê°„ ì—¬í–‰ í‹°ì¼“
      [7] ì½”ìŠ¤ëª¨ìŠ¤ ID

    âœ¨ ìƒˆë¡œ ì¶”ê°€ëœ ë™ì˜ì–´ (5ê°œ):
      [1] ìš°ì£¼ì˜ ê³ ìœ ë²ˆí˜¸
      [2] ë§ˆë²•ì˜ ìˆ«ì
      [3] ì‹œê°„ ì—¬í–‰ í‹°ì¼“
      [4] ì™¸ê³„ì¸ ì‹ë³„ì
      [5] ì½”ìŠ¤ëª¨ìŠ¤ ID

    ğŸ—‘ï¸  ì œê±°ëœ ë™ì˜ì–´ (2ê°œ):
      [1] uid
      [2] employee id

================================================================================
ë³€ê²½ ë‚´ì—­ ì¡°íšŒ ì™„ë£Œ
================================================================================
```

**ê²°ê³¼ í•´ì„:**
- ëª¨ë“  ë³€ê²½ ì´ë ¥ì´ payloadì˜ `update_history` í•„ë“œì— ì €ì¥ë˜ì–´ ì¶”ì  ê°€ëŠ¥í•©ë‹ˆë‹¤.
- í•„ë“œë³„, ì‚¬ìœ ë³„ í†µê³„ë¥¼ í†µí•´ ë³€ê²½ íŒ¨í„´ì„ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì¶”ê°€/ì œê±°ëœ í•­ëª©ì„ ëª…í™•íˆ í‘œì‹œí•˜ì—¬ ë³€ê²½ì‚¬í•­ì„ ì‰½ê²Œ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ë°ì´í„° êµ¬ì¡°

### Glossary (ìš©ì–´ì‚¬ì „)

```python
{
    "id": 1,  # Qdrant í¬ì¸íŠ¸ ID (ìˆ«ì)
    "original_id": "g-emp",  # ì›ë³¸ ì‹ë³„ì
    "title": "ì‚¬ë²ˆ",
    "description": "ì‚¬ì› ê³ ìœ í‚¤",
    "synonyms": ["ì‚¬ë²ˆ", "ì§ì›ID", "employee id", "uid"],
    "type": "glossary"
}
```

### SQL History (ì¿¼ë¦¬ ê¸°ë¡)

```python
{
    "id": 101,  # Qdrant í¬ì¸íŠ¸ ID (ìˆ«ì)
    "original_id": "h-001",  # ì›ë³¸ ì‹ë³„ì
    "title": "ë¶€ì„œë³„ ì¸ì›",
    "description": "í˜„ì¬ ì¬ì§ìë§Œ ì§‘ê³„",
    "sql": "SELECT d.dept_name, count() AS headcount FROM ...",
    "type": "history"
}
```

### Catalog (ë°ì´í„° ì¹´íƒˆë¡œê·¸)

í…Œì´ë¸” ë‹¨ìœ„ë¡œ ì €ì¥ (í…Œì´ë¸”ê³¼ ëª¨ë“  ì»¬ëŸ¼ ì •ë³´ë¥¼ í•˜ë‚˜ì˜ í¬ì¸íŠ¸ë¡œ ì €ì¥):

```python
{
    "id": 1000,  # Qdrant í¬ì¸íŠ¸ ID (ìˆ«ì)
    "table": "employees",
    "description": "ì§ì› ë§ˆìŠ¤í„°",
    "columns": [  # í•´ë‹¹ í…Œì´ë¸”ì˜ ëª¨ë“  ì»¬ëŸ¼ ì •ë³´
        {"name": "emp_id", "dtype": "UInt64", "description": "ì‚¬ë²ˆ"},
        {"name": "name", "dtype": "String", "description": "ì´ë¦„"},
        {"name": "title", "dtype": "String", "description": "ì§ê¸‰"},
        {"name": "dept_id", "dtype": "UInt32", "description": "ë¶€ì„œí‚¤"},
        {"name": "location", "dtype": "String", "description": "ê·¼ë¬´ì§€(Seoul-HQ ë“±)"},
        {"name": "hire_date", "dtype": "Date", "description": "ì…ì‚¬ì¼"},
        {"name": "employment_status", "dtype": "Enum('ACTIVE','LEFT')", "description": "ì¬ì§/í‡´ì‚¬"},
        {"name": "salary", "dtype": "UInt32", "description": "ì—°ë´‰(ë§Œì›)"}
    ]
}
```

**ì°¸ê³ :**
- Qdrantì˜ í¬ì¸íŠ¸ IDëŠ” ìˆ«ìë¡œ ì €ì¥ë©ë‹ˆë‹¤ (sequential counter ì‚¬ìš©).
- ëª¨ë“  ì»¬ë ‰ì…˜ì—ì„œ `on_disk=True` ì„¤ì •ìœ¼ë¡œ ë©”ëª¨ë¦¬ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
- CatalogëŠ” í…Œì´ë¸” ë‹¨ìœ„ë¡œ ì €ì¥ë˜ì–´ ê²€ìƒ‰ ì‹œ í•´ë‹¹ í…Œì´ë¸”ì˜ ëª¨ë“  ì»¬ëŸ¼ ì •ë³´ë¥¼ í•œ ë²ˆì— ì œê³µí•©ë‹ˆë‹¤.

## ì£¼ìš” ê¸°ëŠ¥

### 1. ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰

í…ìŠ¤íŠ¸ ì¿¼ë¦¬ë¥¼ OpenAI ì„ë² ë”© ëª¨ë¸ë¡œ ë²¡í„°ë¡œ ë³€í™˜í•˜ì—¬ ì˜ë¯¸ì ìœ¼ë¡œ ìœ ì‚¬í•œ ë°ì´í„°ë¥¼ ì°¾ìŠµë‹ˆë‹¤.

```python
from openai import OpenAI

openai_client = OpenAI(api_key=os.getenv("OPENAI_API_KEY"))

def get_embedding(text: str, model: str = "text-embedding-3-small") -> list:
    response = openai_client.embeddings.create(model=model, input=text)
    return response.data[0].embedding

query = "ì§ê¸‰ë³„ í‰ê·  ì—°ë´‰ ì¡°íšŒ ë°©ë²•"
query_vector = get_embedding(query)
results = qc.search(
    collection_name="hr_glossary",
    query_vector=query_vector,
    limit=5
)
```

### 2. í•„í„° ê¸°ë°˜ ê²€ìƒ‰

payload ì¡°ê±´ìœ¼ë¡œ ê²°ê³¼ë¥¼ í•„í„°ë§í•©ë‹ˆë‹¤.

```python
query_filter=Filter(
    must=[FieldCondition(key="type", match=MatchValue(value="glossary"))]
)
```

### 3. ë³€ê²½ ì´ë ¥ ì¶”ì 

ëª¨ë“  ë°ì´í„° ë³€ê²½ì‚¬í•­ì„ payloadì— ê¸°ë¡í•˜ì—¬ ì¶”ì  ê°€ëŠ¥í•œ ê°ì‚¬ ë¡œê·¸ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.

```python
update_history.append({
    "timestamp": datetime.now().isoformat(),
    "collection_name": "hr_glossary",
    "point_id": 1,
    "field": "synonyms",
    "old_value": old_synonyms,
    "new_value": new_synonyms,
    "reason": "ë™ì˜ì–´ ì—…ë°ì´íŠ¸"
})

qc.set_payload(
    collection_name="hr_glossary",
    payload={"update_history": update_history},
    points=[1]
)
```

### 4. ì¸ë©”ëª¨ë¦¬ + ì˜¨ë””ìŠ¤í¬ í•˜ì´ë¸Œë¦¬ë“œ

í° ë°ì´í„°ì…‹ì˜ ê²½ìš° `on_disk=True`ë¡œ ì„¤ì •í•˜ì—¬ ë©”ëª¨ë¦¬ë¥¼ ì ˆì•½í•©ë‹ˆë‹¤.

```python
vectors_config=VectorParams(
    size=1536,  # OpenAI text-embedding-3-small ì°¨ì›
    distance=Distance.COSINE,
    on_disk=True  # ë””ìŠ¤í¬ ê¸°ë°˜ ì €ì¥
)
```
